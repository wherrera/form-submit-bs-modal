function _get_data_attributes(e){let t=[];return $(e).each(function(){if(!this.nodeName.startsWith("data-bs")&&this.nodeName.startsWith("data-")){let e=this.nodeName.substring(5).split("-").join("_");t.push({key:e,value:this.nodeValue})}}),t}function form_submit_bs_modal(e){function t(){a.find('div[name="loading"]').hide(),a.find('div[name="body"]').show()}function n(){a.find('div[name="loading"]').show(),a.find('div[name="body"]').hide()}let i=alert;e&&e.error&&"function"==typeof e.error&&(i=e.error);let a=this,o=a.find('button[type="submit"]');o?o.click(function(){a.find("form").submit()}):i("cant find 'submit' button"),a.on("show.bs.modal",function(e){var o=e.relatedTarget,d=o.getAttribute("data-bs-id");n();let r=a.find("form"),s=_get_data_attributes(o.attributes);s.forEach(e=>{let t=r.find(`input[name="${e.key}"]`);t?t.val(e.value):console.warn(`cant find form input for ${e.key}`)});let f=a.find("form").attr("action"),l=a.find("form").attr("method");null!=l&&"POST"!=l.toUpperCase()?$.ajax({method:"GET",url:f,data:{id:d}}).done(function(e){a.find('div[name="loading"]').hide(),a.find('div[name="body"]').show(),Object.keys(e).forEach(t=>{var n=e[t],i=a.find('[name="'+t+'"]');if(i&&n)switch(i.prop("tagName")){case"INPUT":i.val(n);break;case"SELECT":let e=n;Array.isArray(e)||(e=[e]),e.forEach(e=>{let t=e.id?e.id:e,n=e.text?e.text:e;$(i).find("option[value='"+t+"']").length||$(i).append(new Option(n,t,!0,!0)).trigger("change")}),$(i).val(e).trigger("change")}})}).fail(function(e){let t=e.responseJSON;null!=t&&t.message?i(t.message):i("internal server error.")}):t()}),a.find("form").submit(function(e){e.preventDefault(),a.find('div[name="loading"]').show(),a.find('div[name="body"]').hide();let t=a.find("form");var n=t.serialize();let o=t.attr("action"),d=a.find("form").attr("method");$.ajax({url:o,method:d,data:n}).done(function(e,t){let n=e.responseJSON;null!=n&&n.message&&alert(n.message),location.reload()}).fail(function(e){let t=e.responseJSON;null!=t&&t.message?i(t.message):i("internal server error."),a.find('div[name="loading"]').hide(),a.find('div[name="body"]').show()})})}"object"==typeof module&&"object"==typeof module.exports&&(modulal.exports={form_submit_bs_modal:form_submit_bs_modal}),"undefined"!=typeof window&&void 0!==window.document&&function(e){e.fn.form_submit_bs_modal=form_submit_bs_modal}(jQuery);