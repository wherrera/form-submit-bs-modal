function _get_data_attributes(e){let t=[];return $(e).each(function(){if(!this.nodeName.startsWith("data-bs")&&this.nodeName.startsWith("data-")){let e=this.nodeName.substring(5).split("-").join("_");t.push({key:e,value:this.nodeValue})}}),t}function form_submit_bs_modal(e){function t(){var e=i.find('div[name="loading"]');e&&e.hide();var t=i.find('div[name="body"]');t&&t.show()}function a(){var e=i.find('div[name="loading"]');e&&e.show();var t=i.find('div[name="body"]');t&&t.hide()}let n=alert;e&&e.error&&"function"==typeof e.error&&(n=e.error);let i=this,o=i.find('button[type="submit"]');o?o.click(function(){i.find("form").submit()}):n("cant find 'submit' button"),i.on("show.bs.modal",function(e){var o=e.relatedTarget,r=o.getAttribute("data-bs-id");a();let d=i.find("form"),s=_get_data_attributes(o.attributes);s.forEach(e=>{let t=d.find(`input[name="${e.key}"]`);t?t.val(e.value):console.warn(`cant find form input for ${e.key}`)});let f=i.find("form").attr("action"),l=i.find("form").attr("method");null!=l&&"POST"!=l.toUpperCase()?$.ajax({method:"GET",url:f,data:{id:r}}).done(function(e){t(),Object.keys(e).forEach(t=>{var a=e[t],n=i.find('[name="'+t+'"]');if(n)switch(n.prop("tagName")){case"INPUT":"file"!=n.prop("type")&&n.val(a);break;case"SELECT":let e=a;Array.isArray(e)||(e=[e]),e.forEach(e=>{let t=e.id?e.id:e,a=e.text?e.text:e;$(n).find("option[value='"+t+"']").length||$(n).append(new Option(a,t,!0,!0)).trigger("change")}),$(n).val(e).trigger("change")}})}).fail(function(e){let t=e.responseJSON;null!=t&&t.message?n(t.message):n("internal server error.")}):t()}),i.find("form").submit(function(e){e.preventDefault(),i.find('div[name="loading"]').show(),i.find('div[name="body"]').hide();let t=i.find("form"),a=t.attr("action"),o=t.attr("method"),r=t.attr("enctype")||"application/x-www-form-urlencoded",d={};d="multipart/form-data"==r?{url:a,type:o,data:new FormData(t[0]),processData:!1,contentType:!1}:{url:a,type:o,data:t.serialize()},$.ajax(d).done(function(e,t){let a=e.responseJSON;null!=a&&a.message&&alert(a.message),location.reload()}).fail(function(e){let t=e.responseJSON;null!=t&&t.message?n(t.message):n("internal server error."),i.find('div[name="loading"]').hide(),i.find('div[name="body"]').show()})})}"object"==typeof module&&"object"==typeof module.exports&&(modulal.exports={form_submit_bs_modal:form_submit_bs_modal}),"undefined"!=typeof window&&void 0!==window.document&&function(e){e.fn.form_submit_bs_modal=form_submit_bs_modal}(jQuery);